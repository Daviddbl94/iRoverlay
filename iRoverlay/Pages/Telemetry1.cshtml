@page
@model iRoverlay.Pages.Telemetry1Model
@{
    ViewData["Title"] = "Home page";
}

<!DOCTYPE html>
<html>
<head>
    <title>SignalR Example</title>
    <script src="Scripts/jquery-3.6.0.min.js"></script>
    <script src="Scripts/jquery.signalR-2.4.2.min.js"></script>
    <script src="/signalr/hubs"></script> <!-- Incluye el archivo generado automáticamente por SignalR -->
</head>
<body>
    <div id="messages"></div>
    <input type="text" id="messageInput" />
    <button id="sendButton">Send</button>

    <script>
        $(function () {
            var connection = $.hubConnection(); // Crea una nueva conexión SignalR
            var hubProxy = connection.createHubProxy('myHub'); // Crea un proxy para tu hub

            hubProxy.on('receiveMessage', function (message) { // Define el método para recibir mensajes del servidor
                $('#messages').append('<p>' + message + '</p>');
            });

            connection.start().done(function () { // Inicia la conexión
                console.log('SignalR connection established.');
            });

            $('#sendButton').click(function () {
                var message = $('#messageInput').val();
                hubProxy.invoke('sendMessage', message); // Invoca el método del servidor
            });
        });
    </script>
</body>
</html>
